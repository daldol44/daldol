<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>🚀 2028 대입 최신 트랜드 : 선택 과목 유불리 검색</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700;900&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Noto Sans KR', sans-serif; overflow-x: hidden; background-color: #f0f2f5; }
    .badge {
      display: inline-block; padding: 0.3rem 0.7rem; border-radius: 9999px;
      font-size: 0.8rem; font-weight: 700; color: white; text-align: center; min-width: 75px;
      border: 1px solid rgba(255,255,255,0.3);
    }
    .badge-required { background: linear-gradient(135deg, #ef4444, #b91c1c); } /* 필수 */
    .badge-recommended { background: linear-gradient(135deg, #22c55e, #15803d); } /* 권장 */
    .badge-advanced { background: linear-gradient(135deg, #8b5cf6, #6d28d9); } /* 심화권장 */
    .badge-neutral { background: linear-gradient(135deg, #6b7280, #4b5563); } /* 무관 */
    .card-hover { transition: transform 0.3s ease, box-shadow 0.3s ease; position: relative; overflow: hidden; }
    .card-hover:hover { transform: translateY(-10px); box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25); }
    [data-tooltip] { position: relative; }
    [data-tooltip]:hover::after {
        content: attr(data-tooltip); position: absolute; bottom: 100%; left: 50%;
        transform: translateX(-50%); margin-bottom: 5px; background-color: #1f2937; color: #fff;
        padding: 6px 12px; border-radius: 6px; font-size: 0.85rem; white-space: nowrap; z-index: 10;
        box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }
    /* --- 별빛 & 혜성 배경 스타일 --- */
    .galaxy-header {
        background: radial-gradient(ellipse at 50% 10%, #3b82f6 0%, #1e3a8a 50%, #111827 100%);
    }
    .stars-container { position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; pointer-events: none; }
    .star { 
        position: absolute; background-color: white; border-radius: 50%; 
        animation: twinkle 5s infinite, driftLeft 9s ease-in-out infinite alternate;
        will-change: transform, opacity, margin-left;
    }
    @keyframes twinkle { 
      0%, 100% { opacity: 0.35; transform: scale(0.7); } 
      50% { opacity: 1; transform: scale(1.05); } 
    }
    @keyframes driftLeft {
      from { margin-left: 0; }
      to   { margin-left: -30px; }
    }
    
    /* --- 혜성 효과 수정 --- */
    .comet-container {
        position: absolute;
        top: 50%; 
        left: 0;
        width: 100%;
        height: 100px;
        pointer-events: none;
        animation: comet-travel 20s linear infinite;
        animation-delay: 2s;
        z-index: 5;
    }

    @keyframes comet-travel {
        0% { transform: translateX(-250px); }
        100% { transform: translateX(110vw); }
    }

    .comet {
        position: absolute;
        top: 0;
        left: 0;
        width: 250px; 
        height: 2px;
        background: linear-gradient(to left, rgba(255, 255, 255, 0), rgba(255, 255, 255, 0.8) 70%, white 95%);
        border-radius: 50%;
        filter: drop-shadow(0 0 8px rgba(255, 255, 255, 0.8)) drop-shadow(0 0 15px rgba(255, 255, 255, 0.6));
    }

    .comet::after {
        content: '';
        position: absolute;
        right: -2px;
        top: 50%;
        transform: translateY(-50%);
        width: 6px;
        height: 6px;
        border-radius: 50%;
        background-color: #fff;
        box-shadow: 0 0 10px 3px rgba(255, 255, 255, 1), 0 0 25px 8px rgba(200, 220, 255, 0.7);
    }
    
    .comet-particle {
        position: absolute;
        background-color: white;
        border-radius: 50%;
        opacity: 0;
        animation: sparkle-dust 1.8s ease-out infinite;
    }

    @keyframes sparkle-dust {
        0% {
            opacity: 0;
            transform: scale(0.5) translateX(0);
        }
        50% {
            opacity: 1;
            transform: scale(1.2) translateX(-40px);
        }
        100% {
            opacity: 0;
            transform: scale(0.4) translateX(-100px);
        }
    }
    /* --- END --- */
    .accordion-content { max-height: 0; overflow: hidden; transition: max-height 0.5s ease-in-out; }
    .ripple { position: absolute; border-radius: 50%; background: rgba(255, 255, 255, 0.4); transform: scale(0); animation: ripple 0.6s linear; }
    @keyframes ripple { to { transform: scale(4); opacity: 0; } }
    .highlight-box { animation: pulse-bg 3s infinite ease-in-out; }
    @keyframes pulse-bg { 0%, 100% { background-color: #fffbeb; } 50% { background-color: #fef3c7; } }
    .border-glow { animation: borderGlow 4s infinite ease-in-out; }
    @keyframes borderGlow {
      0%, 100% { text-shadow: 0 0 6px rgba(255,255,255,0.7), 0 0 10px rgba(255,255,255,0.5); }
      50% { text-shadow: 0 0 20px rgba(255,255,255,1), 0 0 35px rgba(255,255,255,0.8); }
    }
    .badge-glow { animation: badgeGlow 3s infinite; }
    @keyframes badgeGlow {
      0%, 100% { box-shadow: 0 0 8px 3px rgba(255, 223, 71, 0.6); }
      50% { box-shadow: 0 0 20px 7px rgba(255, 223, 71, 1); }
    }

    .hours-badge { display:inline-block; padding: 0.25rem 0.6rem; border-radius: 9999px;
      font-size: 0.75rem; font-weight: 800; color: white; background: linear-gradient(135deg,#3b82f6,#2563eb);
      box-shadow: 0 6px 14px rgba(37,99,235,0.35); border:1px solid rgba(255,255,255,0.25); }
  
    .galaxy-header p, header p {
      text-shadow: 0 0 6px rgba(255,255,255,0.55), 0 0 14px rgba(191,219,254,0.75);
    }

    /* --- [MODIFIED] 아이콘 효과 스타일 --- */
    /* 핑크색 발자국 아이콘 */
    .neon-icon-pink {
        filter: drop-shadow(0 0 4px #fff) drop-shadow(0 0 8px #f9a8d4) drop-shadow(0 0 12px #ec4899);
        animation: neon-glow-pink 2.5s infinite ease-in-out;
        text-shadow: 0 0 3px rgba(255,255,255,0.7), 0 0 5px rgba(255,255,255,0.5);
    }
    @keyframes neon-glow-pink {
        0%, 100% { filter: drop-shadow(0 0 4px #fff) drop-shadow(0 0 8px #f9a8d4) drop-shadow(0 0 12px #ec4899); }
        50% { filter: drop-shadow(0 0 8px #fff) drop-shadow(0 0 16px #f9a8d4) drop-shadow(0 0 24px #ec4899); }
    }
    
    /* 노란색 화살표 아이콘 */
    .neon-icon-yellow {
        filter: drop-shadow(0 0 4px #fff) drop-shadow(0 0 8px #fef08a) drop-shadow(0 0 12px #facc15);
        animation: neon-glow-yellow 2.5s infinite ease-in-out;
    }
    @keyframes neon-glow-yellow {
        0%, 100% { filter: drop-shadow(0 0 4px #fff) drop-shadow(0 0 8px #fef08a) drop-shadow(0 0 12px #facc15); }
        50% { filter: drop-shadow(0 0 8px #fff) drop-shadow(0 0 16px #fef08a) drop-shadow(0 0 24px #facc15); }
    }

    /* 핑크색 별가루 */
    .stardust-particle-pink {
        position: absolute; top: 50%; left: 50%; width: 4px; height: 4px;
        background: #fff; border-radius: 50%;
        box-shadow: 0 0 6px #fff, 0 0 10px #ec4899;
        opacity: 0; animation: fly-out var(--duration, 1.5s) var(--delay, 0s) infinite ease-out;
        pointer-events: none; transform: translate(-50%, -50%);
    }

    /* 노란색 별가루 */
    .stardust-particle-yellow {
        position: absolute; top: 50%; left: 50%; width: 4px; height: 4px;
        background: #fff; border-radius: 50%;
        box-shadow: 0 0 6px #fff, 0 0 10px #facc15;
        opacity: 0; animation: fly-out var(--duration, 1.5s) var(--delay, 0s) infinite ease-out;
        pointer-events: none; transform: translate(-50%, -50%);
    }

    @keyframes fly-out {
        0% { transform: translate(-50%, -50%) scale(0.8); opacity: 1; }
        100% { transform: translate(calc(-50% + var(--tx, 0px)), calc(-50% + var(--ty, 0px))) scale(0); opacity: 0; }
    }
    @keyframes float-down {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(15px); }
    }
    .scroll-arrow-icon {
        animation: float-down 2s infinite ease-in-out;
    }
    @keyframes float-hint {
        0%, 100% { transform: translateY(0) scale(1); }
        50% { transform: translateY(-5px) scale(1.05); }
    }
    .search-hint-container {
        animation: float-hint 2.5s infinite ease-in-out;
    }
  </style>
</head>
<body class="bg-gray-100 text-gray-800">

  <header class="relative galaxy-header text-white shadow-lg overflow-hidden">
    <div class="stars-container" id="stars-container"></div>
    <div class="comet-container" id="comet-container"></div>
    <div class="container mx-auto px-4 py-16 text-center relative z-10 space-y-4">
      <a href="https://www.youtube.com/@daldol2325" target="_blank" rel="noopener noreferrer"
         class="inline-flex items-center justify-center px-4 py-1 md:px-6 md:py-2 rounded-full shadow-md bg-gradient-to-r from-yellow-300 via-yellow-400 to-yellow-500 text-blue-900 font-extrabold text-sm md:text-base tracking-wide badge-glow">
        ✨ ★ 달돌과학 : 2028 대입 전문 분석팀 ★ ✨
      </a>
      <h1 class="text-4xl md:text-5xl font-black mb-3 border-glow">2028 대입 최신 트랜드 : 자동검색❗️</h1>
      <p class="text-lg md:text-xl text-blue-100 max-w-3xl mx-auto">
         물화생지 어디가 유리❓️ 주당 몇시간 공부❓️👉검색💎
      </p>
      <p class="text-lg md:text-xl text-blue-100 max-w-3xl mx-auto">
        <span class="block mb-1 font-bold">🛡️ 과탐의 수직상승 = 달돌샘 ☎️ <span class="font-extrabold text-yellow-300">010-7594-7857</span></span>
         ⭐️달돌 레전드 시스템⭐️ 원하는 학생으로 만들어드립니다!! 🎓😄🍀
      </p>
      <div class="mt-8 relative max-w-2xl mx-auto">
        <!-- [NEW] 검색 안내 아이콘 -->
        <div id="search-hint-container" class="search-hint-container absolute inset-0 flex items-center justify-center pointer-events-none z-20 transition-opacity duration-300">
            <div class="relative flex items-center justify-center gap-2 p-4" id="search-hint-icon-wrapper">
                <!-- [MODIFIED] 귀여운 강아지 발자국 아이콘 SVG -->
                <svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" viewBox="0 0 256 256" class="neon-icon-pink">
                  <path fill="white" d="M188.3,109.9c-2.1-13.4-13.3-23.4-26.9-23.4c-11.8,0-22,7.3-25.5,17.8a4,4,0,0,1-7.8-2c-3.5-10.5-13.7-17.8-25.5-17.8c-13.6,0-24.8,10-26.9,23.4a4,4,0,0,1-4,3.5h-1.3a28,28,0,0,0-28,28,28.5,28.5,0,0,0,8.4,20.2c8.1,7.5,18.7,13.6,24,22.4a4,4,0,0,1-1.3,5.9,4.1,4.1,0,0,1-2.4.7,4,4,0,0,1-3.5-2.2c-6.1-9.9-18.4-16.9-27.8-25.3A36.5,36.5,0,0,1,64.2,141.4a36,36,0,0,1,36-36h1.3a4,4,0,0,1,4-3.5c2.3-14.7,15.2-26.4,30.5-26.4s28.2,11.7,30.5,26.4a4,4,0,0,1,4,3.5h1.3a36,36,0,0,1,36,36,36.5,36.5,0,0,1-10.8,26.5c-9.4,8.4-21.7,15.4-27.8,25.3a4,4,0,0,1-5.9,1.5,4,4,0,0,1-1.3-5.9c5.3-8.8,15.9-14.9,24-22.4A28.5,28.5,0,0,0,196.2,141.4a28,28,0,0,0-28-28h-1.3a4,4,0,0,1-4-3.5Z"/>
                </svg>
                <span class="text-2xl font-extrabold text-white neon-icon-pink tracking-wider">검색!</span>
            </div>
        </div>
        <input type="text" id="searchInput" placeholder="예: 의예과, 반도체, KAIST, 상위권..." 
               class="w-full p-4 rounded-full text-gray-900 text-lg shadow-inner focus:ring-4 focus:ring-yellow-400 focus:outline-none transition relative z-10">
      </div>
       <!-- [NEW] 스크롤 유도 화살표 -->
      <div id="scroll-arrow-container" class="absolute bottom-[-20px] left-1/2 -translate-x-1/2 opacity-0 pointer-events-none transition-opacity duration-500">
          <div class="scroll-arrow-icon relative" id="scroll-arrow-icon-wrapper">
              <!-- [MODIFIED] 노란색으로 변경 -->
              <svg xmlns="http://www.w3.org/2000/svg" width="80" height="80" viewBox="0 0 24 24" fill="#fef08a" class="neon-icon-yellow">
                  <path d="M12 17.414l-7.707-7.707a1 1 0 0 1 1.414-1.414L12 14.586l6.293-6.293a1 1 0 0 1 1.414 1.414L12 17.414z"></path>
                  <path d="M12 12.414l-7.707-7.707a1 1 0 0 1 1.414-1.414L12 9.586l6.293-6.293a1 1 0 0 1 1.414 1.414L12 12.414z"></path>
              </svg>
          </div>
      </div>
    </div>
  </header>

  <main class="container mx-auto p-4 md:p-8">

    <!-- 전문가 서문: 2028 대입 핵심 변화 -->
    <section class="bg-gradient-to-br from-white to-blue-50 p-6 md:p-10 rounded-2xl shadow-xl mb-16 ring-2 ring-indigo-200">
        <h2 class="text-3xl font-black text-center text-indigo-800 mb-4">
            <span class="text-4xl">🎓</span><br/>🏆 입시 전문가 달돌팀 🚀 : 2028 대입, 무엇이 어떻게 바뀌나?
        </h2>
        <p class="text-center text-gray-600 mb-8 max-w-3xl mx-auto">
			달돌팀의 최신 자료❗️ 최고의 전략👍이 가능합니다.
		</p>
		<p class="text-center text-indigo-700 font-bold mb-8 text-lg">💎 방문주시면, 성공한 선배들처럼 🎯최적 컨설팅🎯해드립니다.💎</p>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 text-center">
            <div class="bg-white p-6 rounded-xl shadow-lg border-t-4 border-red-500 card-hover">
                <h3 class="font-bold text-xl text-red-600 mb-2">1. 내신 5등급제 & 절대평가 병기</h3>
                <p class="text-gray-700 text-sm">
                    내신 등급 변별력이 약화되면서, 단순히 '1등급'이라는 숫자만으로는 부족합니다. 대학은 원점수, 평균, 성취도(A/B/C)와 함께 학생이 수업에서 무엇을 배우고 탐구했는지를 기록한 <strong class="text-red-700">'세부능력 및 특기사항(세특)'</strong>을 훨씬 더 비중 있게 평가합니다.
                </p>
            </div>
            <div class="bg-white p-6 rounded-xl shadow-lg border-t-4 border-green-500 card-hover">
                <h3 class="font-bold text-xl text-green-600 mb-2">2. 수능 선택과목 폐지 & 통합형 수능</h3>
                <p class="text-gray-700 text-sm">
                    더 이상 수능에서 물리, 화학 등을 선택하지 않습니다. 모든 학생이 <strong class="text-green-700">'통합사회'와 '통합과학'</strong>을 응시합니다. 따라서 '선택과목'의 중요성은 오직 <strong class="text-green-700">학생부(내신) 경쟁력</strong>과 <strong class="text-green-700">전공 적합성</strong> 증명에만 존재합니다.
                </p>
            </div>
            <div class="bg-white p-6 rounded-xl shadow-lg border-t-4 border-purple-500 card-hover">
                <h3 class="font-bold text-xl text-purple-600 mb-2">3. 학생부의 영향력 극대화</h3>
                <p class="text-gray-700 text-sm">
                    수시(학생부 종합)는 물론, 정시(수능) 전형에서도 학생부를 반영하는 대학이 늘어날 것입니다. 즉, <strong class="text-purple-700">어떤 과목을 선택하고, 얼마나 깊이 있게 탐구했는가</strong>가 수시와 정시 모두에서 결정적인 영향력을 갖게 되는, 진정한 의미의 '고교학점제형 입시'가 시작됩니다.
                </p>
            </div>
        </div>
    </section>

    <section id="results" class="mb-16">
      <h2 class="text-3xl font-bold text-center text-gray-800 mb-8">⭐️수시 선택과목 유불리 : 학생부종합전형 ⭐️</h2>
      <div id="tablesContainer" class="space-y-12"></div>
    </section>

    <section class="bg-white p-4 md:p-8 rounded-2xl shadow-xl mb-16">
      <h2 class="text-3xl font-bold text-center text-gray-800 mb-8">과학탐구 과목별 분석</h2>
      <div id="subject-analysis-container"></div>
    </section>

    <section class="bg-white p-4 md:p-8 rounded-2xl shadow-xl mb-16">
        <h2 class="text-3xl font-bold text-center text-gray-800 mb-2">핵심 지표 비교 (물·화·생·지)</h2>
        <p class="text-center text-gray-600 mb-6 text-sm">※ 5점 만점, 학습량·난이도·수행평가·수능 연계·스킬 지표를 토대로 비교합니다. 각 색상은 해당 과목을 의미하며, 범례를 클릭하여 숨기거나 겹쳐 비교할 수 있습니다.</p>
        <div class="bg-gray-50 p-4 rounded-xl shadow-inner overflow-x-auto">
            <canvas id="coreMetricsChart"></canvas>
        </div>
    </section>
    
    <section class="bg-indigo-50 p-4 md:p-8 rounded-2xl shadow-lg">
        <h2 class="text-3xl font-bold text-center text-gray-800 mb-2">💡 2028 대입 필승! 최적의 과목 조합 찾기</h2>
        <p class="text-center text-gray-600 mb-8">나의 성향과 목표에 맞는 최상의 조합을 통해, 합격의 길을 여는 전략적 포트폴리오를 구성하세요.</p>
        <div id="combinations-container" class="grid grid-cols-1 lg:grid-cols-2 gap-8"></div>
    </section>
  </main>

  <a href="https://www.youtube.com/@daldol2325" target="_blank" rel="noopener noreferrer"
     class="fixed bottom-6 right-6 z-50 flex items-center gap-2 bg-yellow-500 hover:bg-yellow-400 text-black font-bold py-2 px-4 rounded-full shadow-xl">
    <span>★</span><span>달돌과학 구독</span>
  </a>

  <footer class="bg-gray-800 text-white mt-16">
    <div class="container mx-auto px-4 py-8">
      <div id="references-accordion" class="max-w-4xl mx-auto">
        <button id="accordion-button" class="w-full text-left font-semibold mb-4 text-lg flex justify-between items-center">
          <span>🔗 주요 참고 자료 및 출처 (클릭하여 보기)</span>
          <svg id="accordion-arrow" class="w-5 h-5 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
        </button>
        <div id="accordion-content" class="accordion-content text-sm text-gray-400 space-y-3"></div>
      </div>
    </div>
  </footer>

<script>
document.addEventListener('DOMContentLoaded', () => {
    // UPDATED on 2025-09-20: 2028 대입 개편안 확정 및 주요 대학 권장과목 발표에 따라 데이터베이스 업데이트
    const db = {
        universities: [
            // University list is maintained as is.
            { name: '서울대', group: '최상위권' }, { name: '연세대', group: '최상위권' }, { name: '고려대', group: '최상위권' }, { name: '성균관대', group: '최상위권' }, { name: '서강대', group: '최상위권' }, { name: '한양대', group: '최상위권' }, { name: '중앙대', group: '상위권' }, { name: '이화여대', group: '상위권' }, { name: '경희대', group: '상위권' }, { name: '서울시립대', group: '상위권' }, { name: '건국대', group: '상위권' }, { name: '동국대', group: '상위권' }, { name: '홍익대', group: '중상위권' }, { name: '숭실대', group: '중상위권' }, { name: '국민대', group: '중상위권' }, { name: '세종대', group: '중상위권' }, { name: '아주대', group: '중상위권' }, { name: '인하대', group: '중상위권' }, { name: '광운대', group: '중위권' }, { name: '상명대', group: '중위권' }, { name: '삼육대', group: '중위권' }, { name: '가천대', group: '중위권' }, { name: '가톨릭대', group: '중위권' }, { name: '명지대', group: '중위권' }, { name: 'KAIST', group: '최상위권' }, { name: '포항공대', group: '최상위권' }, { name: 'UNIST', group: '최상위권' }, { name: 'GIST', group: '최상위권' }, { name: 'DGIST', group: '최상위권' }, { name: '한국에너지공대', group: '최상위권' }, { name: '한국항공대', group: '중상위권' }, { name: '경찰대', group: '중상위권' }, { name: '숙명여대', group: '중상위권' }, { name: '성신여대', group: '중상위권' }, { name: '덕성여대', group: '중상위권' }, { name: '동덕여대', group: '중상위권' }, { name: '서울여대', group: '중상위권' },
        ],
        majors: {
            // Base recommendations updated based on general trends and university group research.
            '의예과': {cat:'의약', sub: { '화학': '필수', '생명과학': '필수', '물리학': '권장'}}, 
            '치의예과': {cat:'의약', sub: { '화학': '필수', '생명과학': '필수', '물리학': '권장'}}, 
            '한의예과': {cat:'의약', sub: { '생명과학': '필수', '화학': '권장'}}, 
            '수의예과': {cat:'의약', sub: { '생명과학': '필수', '화학': '필수'}}, 
            '약학과': {cat:'의약', sub: { '화학': '필수', '생명과학': '필수'}}, 
            '간호학과': {cat:'보건', sub: { '생명과학': '권장', '화학': '권장'}}, 
            '물리치료학과': {cat:'보건', sub: { '생명과학': '권장', '물리학': '권장'}}, 
            '방사선학과': {cat:'보건', sub: { '물리학': '권장', '생명과학': '권장'}}, 
            '임상병리학과': {cat:'보건', sub: { '생명과학':'필수', '화학':'권장'}}, 
            '작업치료학과': {cat:'보건', sub: { '생명과학':'권장'}}, 
            '컴퓨터공학': {cat:'IT', sub: { '물리학': '권장' }}, // Will be overridden by top schools to '심화권장'
            '소프트웨어': {cat:'IT', sub: { '물리학': '권장' }}, 
            '인공지능(AI)': {cat:'IT', sub: { '물리학': '권장' }}, 
            '데이터사이언스': {cat:'IT', sub: {}}, 
            '정보보호': {cat:'IT', sub: { '물리학': '권장' }}, 
            '지능형시스템': {cat:'IT', sub: { '물리학': '권장' }}, 
            '미디어학과': {cat:'IT', sub: {}}, 
            '게임공학과': {cat:'IT', sub: {'물리학':'권장'}}, 
            '전기전자공학': {cat:'공학', sub: { '물리학': '필수', '화학': '권장' }}, 
            '기계공학': {cat:'공학', sub: { '물리학': '필수' }}, 
            '화학공학': {cat:'공학', sub: { '화학': '필수', '물리학': '권장'}}, 
            '신소재공학': {cat:'공학', sub: { '화학': '필수', '물리학': '권장'}}, 
            '산업공학': {cat:'공학', sub: {}}, 
            '건축학': {cat:'공학', sub: { '물리학': '권장' }}, 
            '도시공학': {cat:'공학', sub: { '지구과학': '권장' }}, 
            '환경공학': {cat:'공학', sub: { '화학': '권장', '생명과학': '권장' }}, 
            '항공우주공학': {cat:'공학', sub: { '물리학': '필수' }}, 
            '반도체공학': {cat:'공학', sub: { '물리학': '필수', '화학': '필수' }}, 
            '반도체시스템공학': {cat:'공학', sub: { '물리학': '필수', '화학': '권장' }}, 
            '에너지공학': {cat:'공학', sub: { '물리학': '권장', '화학': '권장' }}, 
            '로봇공학': {cat:'공학', sub: { '물리학': '필수' }}, 
            '미래자동차공학': {cat:'공학', sub: {'물리학':'필수'}}, 
            '바이오메디컬공학': {cat:'공학', sub: {'생명과학':'권장', '화학':'권장', '물리학':'권장'}}, 
            '지능형반도체': {cat:'공학', sub: {'물리학':'필수', '화학':'권장'}}, 
            '생명공학': {cat:'자연', sub: { '생명과학': '필수', '화학': '권장'}}, 
            '생명과학': {cat:'자연', sub: { '생명과학': '필수', '화학': '권장'}}, 
            '물리학과': {cat:'자연', sub: { '물리학': '필수' }}, 
            '화학과': {cat:'자연', sub: { '화학': '필수' }}, 
            '수학과': {cat:'자연', sub: {}}, 
            '통계학과': {cat:'자연', sub: {}}, 
            '지구환경과학': {cat:'자연', sub: { '지구과학': '권장' }}, 
            '천문우주학과': {cat:'자연', sub: { '물리학': '권장', '지구과학': '권장' }}, 
            '식품영양학과': {cat:'자연', sub: { '화학': '권장', '생명과학': '권장' }}, 
            '뇌과학': {cat:'자연', sub: {'생명과학': '필수', '화학': '권장'}}, 
            '해양과학': {cat:'자연', sub: {'지구과학': '권장', '생명과학':'권장'}}, 
            '의류학과(자연)': {cat:'자연', sub: {'화학':'권장'}}, 
            '화장품학': {cat:'자연', sub: {'화학':'필수', '생명과학':'권장'}}, 
            '스마트팜': {cat:'자연', sub: {'생명과학':'권장', '화학':'권장'}}, 
            '항공운항학': {cat:'공학', sub: { '물리학': '권장', '지구과학': '권장' }}
        },
        overrides: [
            // UPDATED DATA: 서울대, 연세대, 고려대 등 최상위권 대학의 권장과목을 '심화권장'으로 명시하고 구체적인 note 추가
            { univ: '서울대', major: '의예과', subjects: { '화학': '심화권장', '생명과학': '심화권장' }, note: '화학Ⅱ, 생명과학Ⅱ 이수가 사실상 필수' }, 
            { univ: '서울대', major: '치의예과', subjects: { '화학': '심화권장', '생명과학': '심화권장' }},
            { univ: '서울대', major: '수의예과', subjects: { '화학': '심화권장', '생명과학': '심화권장' }},
            { univ: '서울대', major: '기계공학', subjects: { '물리학': '심화권장' }, note: '물리학Ⅱ 이수 강력 권장' }, 
            { univ: '서울대', major: '전기전자공학', subjects: { '물리학': '심화권장' } }, 
            { univ: '서울대', major: '컴퓨터공학', subjects: { '물리학': '심화권장' } }, 
            { univ: '서울대', major: '항공우주공학', subjects: { '물리학': '심화권장' } }, 
            { univ: '연세대', major: '의예과', subjects: { '화학': '심화권장', '생명과학': '심화권장' }},
            { univ: '연세대', major: '치의예과', subjects: { '화학': '심화권장', '생명과학': '심화권장' }},
            { univ: '연세대', major: '약학과', subjects: { '화학': '심화권장', '생명과학': '심화권장' } }, 
            { univ: '연세대', major: '인공지능(AI)', subjects: { '물리학': '심화권장' } }, 
            { univ: '연세대', major: '반도체시스템공학', subjects: { '물리학': '심화권장', '화학': '필수' }, note: '계약학과 특성상 심화과목 중요' },
            { univ: '고려대', major: '의예과', subjects: { '화학': '심화권장', '생명과학': '심화권장' }, note: '심화과학 2과목 이상 이수 권장' }, 
            { univ: '고려대', major: '반도체공학', subjects: { '물리학': '심화권장', '화학': '필수' } }, 
            { univ: '고려대', major: '스마트모빌리티학부', subjects: { '물리학': '심화권장' } },
            { univ: '성균관대', major: '반도체시스템공학', subjects: { '물리학': '심화권장' } }, 
            { univ: '한양대', major: '데이터사이언스', subjects: { '물리학': '권장' } }, 
            { univ: '경희대', note: '과학 진로선택과목 이수 시 가산점 부여 가능성 높음' }, 
            { univ: '동국대', note: 'AI융합학부 등 특정 학과 과학 교과 가중치 적용' }, 
            { univ: '건국대', note: '과탐 필수/가산점 폐지로 교차지원 유연' }, 
            { univ: '세종대', major: '지능형드론공학', subjects: {'물리학':'필수'}}, 
            { univ: '한국항공대', major: '항공운항학', subjects: { '물리학': '필수', '지구과학': '권장' } }, 
            { univ: '한국항공대', major: '항공우주공학', subjects: { '물리학': '필수', '지구과학': '권장' } }, 
            { univ: 'KAIST', note: '전공에 따라 물리, 화학, 생명과학 심화과목 이수 매우 중요' },
            { univ: 'KAIST', major: '물리학과', subjects: { '물리학': '심화권장', '화학': '권장' } }, 
            { univ: 'KAIST', major: '화학과', subjects: { '화학': '심화권장', '물리학': '권장' } }, 
            { univ: '포항공대', note: 'KAIST와 유사, 수학/과학 심화 역량 핵심 평가 요소' },
            { univ: '포항공대', major: '기계공학', subjects: { '물리학': '심화권장', '화학': '권장' } },
        ],
        strategies: {
            // Strategy text maintained, as it is fundamentally sound.
            '물리학': { icon: '⚛️', levels: [ { grade: 1, plan: "주 6~8시간" }, { grade: 2, plan: "주 5~6시간" }, { grade: 3, plan: "주 4~5시간" } ], details: [ {grade: 1, text: "개념의 논리적 증명과 킬러 문항(역학, 전자기)에 집중. 수행평가는 탐구 보고서 형태로 깊이 있게 준비."}, {grade: 2, text: "EBS 연계교재로 선행 후, 학교 수업으로 심화. 오답노트로 역학 파트 약점 보완. 수행평가는 실험 설계 중심으로."}, {grade: 3, text: "교과서 기본 문제와 공식 암기 후 유형별 문제풀이 반복. 전공 필수가 아니라면 전략적 포기도 고려."} ] },
            '화학': { icon: '🧪', levels: [ { grade: 1, plan: "주 6~7시간" }, { grade: 2, plan: "주 5~6시간" }, { grade: 3, plan: "주 4~5시간" } ], details: [ {grade: 1, text: "양적 관계, 중화 반응 킬러 유형 정복 목표. 전 단원 꼼꼼한 개념 학습 필수. 수행평가는 실험 과정의 정확성 어필."}, {grade: 2, text: "1, 4단원에 집중하며 암기와 계산 능력 균형 맞추기. 주기적 백지 복습으로 암기량 관리."}, {grade: 3, text: "빈출 개념 위주로 암기. 계산 문제는 기본 유형만 반복하고, 암기 단원에서 점수 확보 전략."} ] },
            '생명과학': { icon: '🧬', levels: [ { grade: 1, plan: "주 5~6시간" }, { grade: 2, plan: "주 4~5시간" }, { grade: 3, plan: "주 3~4시간" } ], details: [ {grade: 1, text: "유전 파트 완전 정복에 시간 투자. 나머지 단원은 마인드맵으로 체계화하여 암기. 수행평가는 유전 가계도 분석 보고서."}, {grade: 2, text: "개념 암기와 자료 해석 능력 향상에 집중. 기출문제 분석으로 빈출 자료 유형 파악. 수행평가는 교과서 탐구 활동 충실히."}, {grade: 3, text: "암기 위주로 접근하여 등급 확보. 스토리텔링으로 개념을 연결하고, 용어 암기에 집중."} ] },
            '지구과학': { icon: '🌏', levels: [ { grade: 1, plan: "주 4~5시간" }, { grade: 2, plan: "주 3~4시간" }, { grade: 3, plan: "주 2~3시간" } ], details: [ {grade: 1, text: "전 범위 꼼꼼한 개념 암기와 자료 해석 연습. 천체 파트는 별도 시간 투자 필요. 실수 줄이기가 관건."}, {grade: 2, text: "기출문제 반복으로 문제 유형 익히기. 교과서의 모든 그림, 그래프, 표를 완벽히 이해."}, {grade: 3, text: "암기 효율을 극대화. 내신 평균 등급을 올리는 전략 과목으로 활용. 전공 부적합성은 감수."} ] }
        },
        combinations: [
             // UPDATED DATA: 'path' values are updated to official 2022 revised curriculum subject names.
            { name: "물리학 + 화학", profile: "최상위 공학도", data: [5, 5, 2, 4, 5], adv: "반도체, 신소재, 전기전자, 기계, 화공 등 거의 모든 최상위 공학계열", pros: "이공계열의 가장 표준적인 조합. 대부분의 상위권 대학에서 요구하는 핵심 역량을 증명하여 전공 적합성 평가에서 최고점을 받을 수 있습니다. 세특에 심화 탐구 내용을 기록하기 가장 용이합니다.", cons: "두 과목 모두 상당한 계산 능력과 깊이 있는 개념 이해를 요구하여 학습 부담이 매우 크며, 최상위권이 아닐 경우 내신 등급 관리에 어려움을 겪을 수 있습니다.", path: {y2s1: ['물리학', '화학'], y2s2: ['역학과 에너지', '화학 반응의 세계']}, trend: [58, 60, 62], trend_desc: "가장 전통적이고 안정적인 이과 상위권 조합으로, 선택 비율이 압도적으로 높고 꾸준히 유지될 전망입니다." },
            { name: "화학 + 생명과학", profile: "의치약학 지망생", data: [5, 4, 3, 5, 4], adv: "의예, 치의예, 약학, 수의예, 생명공학, 화장품학 등", pros: "의약학 및 생명과학 계열 지원을 위한 가장 정석적인 조합입니다. 두 과목의 내용이 유기적으로 연결되어 시너지 효과와 함께 깊이 있는 세특 작성이 가능합니다.", cons: "두 과목 모두 암기량이 방대하며, 화학의 양적 관계와 생명과학의 유전 파트가 '킬러 문항'으로 작용하여 동시에 발목을 잡을 위험이 있습니다.", path: {y2s1: ['화학', '생명과학'], y2s2: ['화학 반응의 세계', '생물의 유전']}, trend: [52, 58, 65], trend_desc: "의약학 계열 선호 현상이 지속되면서, 이 조합의 선택 비율은 앞으로도 계속해서 증가할 것으로 보입니다." },
            { name: "물리학 + 지구과학", profile: "전략적 공학도", data: [4, 3, 4, 2, 3], adv: "건축, 도시, 항공우주, 지구환경, 천문우주 등", pros: "물리학의 높은 난이도를 상대적으로 평이한 지구과학으로 보완할 수 있습니다. 내신 등급을 안정적으로 관리하며 전공 필수과목을 챙기는 전략적 선택입니다.", cons: "화학을 필수로 요구하는 화학공학, 신소재공학 등 일부 상위권 학과 지원 시 전공 적합성에서 불리하게 작용할 수 있어 세특 관리가 중요합니다.", path: {y2s1: ['물리학', '지구과학'], y2s2: ['역학과 에너지', '지구시스템과학']}, trend: [40, 42, 43], trend_desc: "안정적인 등급 확보를 중시하는 중상위권 학생들을 중심으로 꾸준한 선택을 받을 것으로 예상됩니다." },
            { name: "생명과학 + 지구과학", profile: "안정지향 수험생", data: [2, 2, 5, 4, 2], adv: "간호, 보건, 식품영양, 환경, 해양과학 등", pros: "4과목 중 학습 부담이 가장 적어 내신 등급 확보에 가장 유리한 조합입니다. 암기와 자료 해석에 강점이 있는 학생에게 최적입니다.", cons: "최상위권 공과대학 및 자연과학대학 지원 시, 학업 역량과 도전 정신을 보여주기 어려워 전공 적합성 평가에서 매우 불리할 수 있습니다.", path: {y2s1: ['생명과학', '지구과학'], y2s2: ['세포와 물질대사', '지구시스템과학']}, trend: [35, 33, 30], trend_desc: "학습량 부담으로 인해 선택 비율이 높지만, 상위권 변별력이 낮아 최상위권에서는 점차 감소할 수 있습니다." },
            { name: "물리학 + 생명과학", profile: "첨단 융합인재", data: [4, 4, 3, 3, 3], adv: "의공학, 뇌과학, 바이오메디컬, 재활/물리치료 등", pros: "물리학적 원리와 생명 현상을 동시에 이해하는 융합적 역량을 어필할 수 있어, 최근 각광받는 첨단 융합 학과에 매우 적합합니다. 세특 주제 확장이 용이합니다.", cons: "두 과목의 학습 내용 및 문제 해결 방식이 상이하여 시너지 효과를 기대하기 어려우며, 각각 별도의 깊이 있는 학습이 요구됩니다.", path: {y2s1: ['물리학', '생명과학'], y2s2: ['역학과 에너지', '생물의 유전']}, trend: [15, 18, 22], trend_desc: "첨단 융합 학문의 인기가 높아짐에 따라, 이 조합의 선택 비율은 앞으로 점진적으로 상승할 것입니다." },
            { name: "화학 + 지구과학", profile: "실속파 수험생", data: [3, 3, 4, 3, 3], adv: "환경공학, 해양과학, 도시공학, 일부 신소재 계열", pros: "범용성 높은 화학을 챙기면서, 지구과학으로 학습 부담을 조절하는 실리적인 조합입니다. 중위권 학생이 안정적으로 성적을 관리하기에 좋습니다.", cons: "물리학을 필수로 요구하는 기계공학, 전기전자공학 등 핵심 공과대학 지원이 사실상 불가능해져 상위권 대학 선택의 폭이 좁아집니다.", path: {y2s1: ['화학', '지구과학'], y2s2: ['화학 반응의 세계', '행성우주과학']}, trend: [12, 11, 10], trend_desc: "상위권 공대 지원의 한계로 인해, 선택 비율은 현상 유지 또는 소폭 감소할 가능성이 있습니다." },
            // RESTORED Social Studies combinations
            { name: "생명과학 + 화학 + 현대사회와 윤리", profile: "의생명·윤리 융합 전문가", data: [5, 2, 3, 4, 3], adv: "의료윤리, 생명윤리정책, 보건의료 마케팅, 제약/바이오 R&D, 뇌인지과학", pros: "자연과학적 탐구 역량과 윤리적 통찰력을 동시에 어필 가능. 특히 의약학 계열 심층 면접에서 생명 윤리 관련 질문에 강점을 보일 수 있습니다.", cons: "세 과목 모두 암기량이 많고 학습 연관성이 낮아 시간 투자가 많이 필요합니다. 전통 공학계열 지원 시 전공 적합성 어필이 다소 약할 수 있습니다.", path: {y2s1: ['생명과학', '화학', '현대사회와 윤리'], y2s2: ['생물의 유전', '화학 반응의 세계', '윤리문제 탐구']}, trend: [5, 8, 12], trend_desc: "융합형 인재 선호도 증가 및 의학 계열의 윤리 의식 강조로 인해 선택 비율이 꾸준히 상승할 전망입니다." },
            { name: "생명과학 + 지구과학 + 사회와 문화", profile: "인간/환경·정책 전문가", data: [3, 2, 4, 3, 3], adv: "환경정책, 보건행정, 소비자학, 사회복지, 생활과학 등", pros: "학습 부담이 비교적 적어 내신 관리에 유리하며, 과학적 지식과 사회 현상에 대한 이해를 결합하여 문·이과 융합형 인재임을 보여줄 수 있습니다.", cons: "최상위권 이공계열 지원 시 심층적인 학업 역량을 보여주기에는 다소 부족할 수 있습니다. 세 과목 간 시너지가 약해 개별 학습이 중요합니다.", path: { y2s1: ['생명과학', '지구과학', '사회와 문화'], y2s2: ['세포와 물질대사', '지구시스템과학', '사회문제 탐구'] }, trend: [8, 10, 13], trend_desc: "문이과 통합 교육 과정의 안정화에 따라, 다양한 분야로의 진출을 모색하는 학생들에게 꾸준히 선택받을 것입니다." },
        ],
        references: [
            // UPDATED DATA: More specific and recent sources added.
            {text: "교육부 「미래 사회를 대비하는 2028 대학입시제도 개편 확정안」", url: "https://www.moe.go.kr/boardCnts/viewRenew.do?boardID=294&boardSeq=97551&lev=0&searchType=null&statusYN=W&page=1&s=moe&m=020402&opType=N"},
            {text: "서울대학교 「2028학년도 대학 신입학생 입학전형 전공 연계 교과이수 과목 안내」", url: "http://www.veritas-a.com/news/articleView.html?idxno=560797"},
            {text: "고려대학교 「2028학년도 대입전형 수립을 위한 고교-대학 연계 포럼 자료집」", url: "https://www.kyobit.com/news/articleView.html?idxno=1459"},
            {text: "연세대 등 5개 대학 공동연구 「2028학년도 대입개편에 따른 전형 개선 연구」", url: "https://www.megastudy.net/mobile/smart/entinfo/brd/list.asp?t_Gubun=7&pidx=7409"},
            {text: "대입정보포털 「어디가」 - 대학별 입학정보", url: "https://www.adiga.kr/"}, 
            {text: "서울특별시교육청교육연구정보원 「2022 개정 교육과정 선택과목 안내서」", url: "https://jinhak.sen.go.kr/jinhak/common/file/download.do?fileSeq=434606&bbsId=B0000030"}, 
            {text: "베리타스알파 - 2028 대입개편 뉴스", url: "http://www.veritas-a.com/"},
        ]
    };
    
    const searchInput = document.getElementById('searchInput');
    const tablesContainer = document.getElementById('tablesContainer');
    const subjectAnalysisContainer = document.getElementById('subject-analysis-container');
    const combinationsContainer = document.getElementById('combinations-container');
    
    // [NEW] 새 요소 가져오기
    const searchHint = document.getElementById('search-hint-container');
    const scrollArrow = document.getElementById('scroll-arrow-container');

    // [MODIFIED] 별가루 효과 생성 함수 (클래스 이름 인자 받도록 수정)
    function createStardust(container, particleClass, count = 20) {
        if (!container) return;
        let particlesHTML = '';
        for (let i = 0; i < count; i++) {
            const angle = Math.random() * 360;
            const distance = Math.random() * 50 + 40; // 40px to 90px
            const duration = Math.random() * 1.5 + 1; // 1 to 2.5s
            const delay = Math.random() * duration;
            const tx = Math.cos(angle * Math.PI / 180) * distance + 'px';
            const ty = Math.sin(angle * Math.PI / 180) * distance + 'px';
            particlesHTML += `<div class="${particleClass}" style="--tx: ${tx}; --ty: ${ty}; --duration: ${duration}s; --delay: -${delay}s;"></div>`;
        }
        container.insertAdjacentHTML('beforeend', particlesHTML);
    }


    function renderAll() {
        createStars(320);
        createComet();
        renderTables(searchInput.value);
        renderSubjectAnalysis();
        renderCombinations();
        renderCoreMetrics();
        renderReferences();
        setupAccordion();
        setupRippleEffect();
        // [MODIFIED] 별가루 효과 적용 (각각 다른 클래스 전달)
        createStardust(document.getElementById('search-hint-icon-wrapper'), 'stardust-particle-pink', 25);
        createStardust(document.getElementById('scroll-arrow-icon-wrapper'), 'stardust-particle-yellow', 35);
    }

    function createStars(count) {
        const container = document.getElementById('stars-container');
        if (!container) return;
        let starsHtml = '';
        for (let i = 0; i < count; i++) {
            const size = Math.random() * 2 + 0.5;
            const x = Math.random() * 100;
            const y = Math.random() * 100;
            const delay = Math.random() * 5;
            const duration = Math.random() * 3 + 4;
            starsHtml += `<div class="star" style="width:${size}px; height:${size}px; left:${x}%; top:${y}%; animation-delay:${delay}s; animation-duration:${duration}s;"></div>`;
        }
        container.innerHTML = starsHtml; 
    }
    
    
    function createComet() {
        const container = document.getElementById('comet-container');
        if (!container) return;
        container.innerHTML = ''; 

        const comet = document.createElement('div');
        comet.className = 'comet';

        const particleCount = 40;
        for (let i = 0; i < particleCount; i++) {
            const p = document.createElement('div');
            p.className = 'comet-particle';
            
            const size = Math.random() * 2 + 1;
            p.style.width = `${size}px`;
            p.style.height = `${size}px`;

            const trailOffset = -Math.random() * 200; 
            const spreadY = (Math.random() - 0.5) * 20;    
            
            p.style.left = `${trailOffset}px`;
            p.style.top = `${spreadY}px`;
            p.style.animationDelay = `${(Math.random() * 1.8).toFixed(2)}s`;
            
            comet.appendChild(p);
        }
        container.appendChild(comet);
    }
    

    function renderTables(query = '') {
        const q = query.trim().toLowerCase();
        const dataToRender = db.universities.flatMap(univ => {
            return Object.entries(db.majors).map(([major, majorData]) => {
                if (q && !major.toLowerCase().includes(q) && !univ.name.toLowerCase().includes(q) && !univ.group.toLowerCase().includes(q) && !majorData.cat.toLowerCase().includes(q)) {
                    return null;
                }
                let finalSubjects = { '물리학': '무관', '화학': '무관', '생명과학': '무관', '지구과학': '무관', ...majorData.sub };
                
                // Apply general override for the university first
                const generalOverride = db.overrides.find(o => o.univ === univ.name && !o.major);
                if(generalOverride && generalOverride.note) {
                    // This note will be attached to the university header, not individual subjects
                }
                
                // Apply major-specific override
                const majorOverride = db.overrides.find(o => o.univ === univ.name && o.major === major);
                if (majorOverride && majorOverride.subjects) {
                    Object.assign(finalSubjects, majorOverride.subjects);
                }
                
                return { 
                    university: univ.name, 
                    major, 
                    group: univ.group, 
                    subjects: finalSubjects,
                    note: majorOverride?.note || generalOverride?.note // Prioritize major-specific note
                };
            }).filter(Boolean);
        });

        const groupedByUniv = dataToRender.reduce((acc, item) => {
            if (!acc[item.university]) acc[item.university] = { group: item.group, majors: [], note: '' };
            acc[item.university].majors.push(item);
            // Find a general note for the university header
            const univNote = db.overrides.find(o => o.univ === item.university && !o.major && o.note);
            if(univNote) acc[item.university].note = univNote.note;

            return acc;
        }, {});

        tablesContainer.innerHTML = Object.keys(groupedByUniv).length === 0 
            ? '<p class="text-center text-gray-500 text-lg">검색 결과가 없습니다. 다른 키워드로 검색해보세요.</p>'
            : Object.entries(groupedByUniv).sort((a,b) => a[0].localeCompare(b[0])).map(([univName, data]) => {
                return `
                <div class="bg-white rounded-2xl shadow-md overflow-hidden card-hover">
                  <div class="p-4 bg-gray-100 border-b-2 border-gray-200 flex justify-between items-center flex-wrap gap-2">
                    <div class="flex items-center gap-3">
                      <h3 class="text-xl md:text-2xl font-bold text-blue-800">${univName} <span class="text-base md:text-lg font-medium text-gray-600">(${data.group})</span></h3>
                    </div>
                    ${data.note ? `<p class="text-xs md:text-sm text-indigo-600 font-semibold text-right w-full sm:w-auto">${data.note}</p>` : ''}
                  </div>
                  <div class="overflow-x-auto">
                    <table class="w-full min-w-max">
                      <thead><tr class="bg-gray-50 text-xs text-gray-500 uppercase">
                          <th class="p-3 text-left font-semibold">모집단위</th>
                          <th class="p-3 text-center font-semibold">물리학</th><th class="p-3 text-center font-semibold">화학</th>
                          <th class="p-3 text-center font-semibold">생명과학</th><th class="p-3 text-center font-semibold">지구과학</th>
                      </tr></thead>
                      <tbody class="divide-y divide-gray-200">
                        ${data.majors.sort((a,b) => a.major.localeCompare(b.major)).map(m => `
                            <tr class="hover:bg-gray-50">
                              <td class="p-3 font-bold text-sm">${m.major} ${m.note ? `<span class="text-indigo-500 text-xs font-normal block sm:inline sm:ml-2">(${m.note})</span>` : ''}</td>
                              ${Object.entries(m.subjects).map(([subName, s]) => `<td class="p-3 text-center">${getBadge(s, subName)}</td>`).join('')}
                            </tr>
                        `).join('')}
                      </tbody>
                    </table>
                  </div>
                </div>
            `}).join('');
    }
    
    function getBadge(value, subjectName) {
        let cls = 'badge-neutral', text = value.split('(')[0];
        if (value.includes('필수')) cls = 'badge-required';
        else if (value.includes('심화권장')) { cls = 'badge-advanced'; text = "심화권장"; }
        else if (value.includes('권장')) cls = 'badge-recommended';
        return `<span class="badge ${cls}" data-tooltip="${subjectName}: ${value}">${text}</span>`;
    }

    function renderSubjectAnalysis() {
        subjectAnalysisContainer.innerHTML = Object.entries(db.strategies).map(([subject, data]) => `
            <div class="mb-12">
                <h3 class="text-2xl font-bold text-blue-700 mb-4 flex items-center">🚀 ${subject} 등급 수직상승 전략</h3>
                <div class="bg-gray-50 rounded-lg p-6">
                    <div class="mb-6">
                        <h4 class="font-bold text-lg mb-2 text-center">등급별 주간 최소 학습 시간</h4>
                        <div class="flex items-end space-x-4 h-48 p-4 justify-center">
                        ${data.levels.map(level => `
                            <div class="text-center flex-1 h-full flex flex-col justify-end max-w-xs">
                                <div class="bg-blue-200 rounded-t-lg mx-auto w-3/4" style="height: ${parseInt(level.plan.match(/\d+/)[0]) * 12}px;"></div>
                                <div class="text-sm font-bold bg-blue-500 text-white py-1 rounded-b-lg w-3/4 mx-auto">${level.plan}</div>
                                <div class="text-xs mt-1 font-semibold">${level.grade}등급</div>
                            </div>
                        `).join('')}
                        </div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        ${data.details.map(detail => `
                            <div class="card-hover bg-white p-4 rounded-lg shadow-sm border border-gray-200">
                                <h4 class="font-bold text-lg text-blue-600 mb-2">${detail.grade}등급 학생 전략</h4>
                                <p class="text-sm text-gray-700">${detail.text}</p>
                            </div>
                        `).join('')}
                    </div>
                </div>
            </div>
        `).join('');
    }

    function renderCombinations() {
        const comboHours = {
            '물리학 + 화학': '⏳ 주당 약 20~25시간', 
            '화학 + 생명과학': '⏳ 주당 약 18~22시간', 
            '물리학 + 지구과학': '⏳ 주당 약 16~20시간', 
            '생명과학 + 지구과학': '⏳ 주당 약 14~18시간', 
            '물리학 + 생명과학': '⏳ 주당 약 17~21시간', 
            '화학 + 지구과학': '⏳ 주당 약 15~19시간',
            '생명과학 + 화학 + 현대사회와 윤리': '⏳ 주당 약 18~23시간',
            '생명과학 + 지구과학 + 사회와 문화': '⏳ 주당 약 15~20시간'
        };
        combinationsContainer.innerHTML = db.combinations.map((combo, index) => `
            <div class="card-hover bg-white rounded-xl shadow-md p-6">
                <div class="flex flex-col md:flex-row gap-6">
                    <div class="md:w-1/2">
                        <h4 class="text-xl font-bold text-indigo-700 mb-1">${combo.name}</h4>
                        <p class="text-sm font-semibold text-gray-600 mb-2">추천 프로필: <span class="text-indigo-700">${combo.profile}</span></p>
                        <span class="hours-badge mb-4">${comboHours[combo.name] || "⏳ 주당 약 15~20시간"}</span>
                    </div>
                    <div class="md:w-1/2">
                        <div class="mt-2 p-3 highlight-box border-l-4 border-yellow-400 rounded-r-lg">
                            <p class="text-sm text-gray-700"><strong class="font-bold text-yellow-800">✨ 추천 학과:</strong> ${combo.adv}</p>
                        </div>
                    </div>
                </div>

                <div class="flex flex-col md:flex-row gap-6 mt-4 items-center">
                    <div class="w-full md:w-1/2 h-64"><canvas id="comboRadarChart${index}"></canvas></div>
                    <div class="w-full md:w-1/2">
                        <div class="h-48"><canvas id="comboTrendChart${index}"></canvas></div>
                        <p class="text-xs text-center text-gray-600 mt-2">${combo.trend_desc || ""}</p>
                    </div>
                </div>

                <div class="mt-6">
                    <h5 class="font-bold mb-2">2학년 선택과목 이수 경로 (예시)</h5>
                    <div class="text-sm space-y-2 bg-gray-50 p-3 rounded-lg mb-4">
                        <div class="flex items-center">
                            <span class="font-bold text-blue-600 mr-2 w-24">일반선택:</span>
                            <span>${combo.path.y2s1.join(' + ')}</span>
                        </div>
                        <div class="text-center text-gray-400">▼</div>
                        <div class="flex items-center">
                            <span class="font-bold text-purple-600 mr-2 w-24">진로선택:</span>
                            <span>${combo.path.y2s2.join(' + ')}</span>
                        </div>
                    </div>
                    <div class="text-sm space-y-2">
                        <p><strong class="text-blue-600">👍 장점:</strong> ${combo.pros}</p>
                        <p><strong class="text-red-600">👎 단점:</strong> ${combo.cons || "특별한 단점 없음"}</p>
                    </div>
                </div>
            </div>
        `).join('');
        
        db.combinations.forEach((combo, index) => {
            const radarCtx = document.getElementById(`comboRadarChart${index}`).getContext('2d');
            new Chart(radarCtx, {
                type: 'radar',
                data: {
                    labels: ['전공적합성', '학습량↓', '내신확보', '세특연계', '범용성'],
                    datasets: [{
                        label: '조합 특성',
                        data: [combo.data[0], 6 - combo.data[1], combo.data[2], combo.data[3], combo.data[4]],
                        backgroundColor: 'rgba(99, 102, 241, 0.2)', borderColor: 'rgba(99, 102, 241, 1)',
                        borderWidth: 2, pointBackgroundColor: 'rgba(99, 102, 241, 1)',
                    }]
                },
                options: {
                    responsive: true, maintainAspectRatio: true,
                    scales: { r: { angleLines: { display: true }, suggestedMin: 0, suggestedMax: 5, pointLabels: { font: { size: 11 } }, ticks: { display: false, stepSize: 1 } } },
                    plugins: { legend: { display: false } }
                }
            });

            const trendCtx = document.getElementById(`comboTrendChart${index}`).getContext('2d');
            new Chart(trendCtx, {
                type: 'bar',
                data: {
                    labels: ['2026', '2027', '2028'],
                    datasets: [{
                        data: combo.trend || [0, 0, 0],
                        backgroundColor: 'rgba(244, 114, 182, 0.6)', borderColor: 'rgba(244, 114, 182, 1)',
                        borderWidth: 1, barThickness: 12, maxBarThickness: 14, borderRadius: 4
                    }]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    scales: {
                        x: { ticks: { font: { size: 11 } }, grid: { display: false } },
                        y: { 
                            beginAtZero: true, max: 70, 
                            ticks: { 
                                stepSize: 10, font: { size: 11 },
                                callback: function(value) { return value + '%'; }
                            } 
                        }
                    },
                    plugins: { 
                        legend: { display: false }, 
                        tooltip: { enabled: true },
                        title: { display: true, text: '전국 선택 비율 예상(%)', font: { size: 14, weight: 'bold' } }
                    }
                }
            });
        });
    }

    function renderCoreMetrics() {
        const ctx = document.getElementById('coreMetricsChart').getContext('2d');
        if (window.coreChart) window.coreChart.destroy();
        const data = {
            labels: ['공부량', '난이도', '수행평가량', '세특 연계', '국어 스킬', '수학 스킬'],
            datasets: [
                { label: '물리학', data: [5, 5, 3, 4, 2, 5], backgroundColor: 'rgba(79, 70, 229, 0.6)', borderColor: 'rgba(79, 70, 229, 1)', borderWidth: 1 }, { label: '화학', data: [4, 4, 4, 5, 3, 4], backgroundColor: 'rgba(34, 197, 94, 0.6)', borderColor: 'rgba(34, 197, 94, 1)', borderWidth: 1 }, { label: '생명과학', data: [3, 4, 4, 4, 4, 3], backgroundColor: 'rgba(234, 179, 8, 0.6)', borderColor: 'rgba(234, 179, 8, 1)', borderWidth: 1 }, { label: '지구과학', data: [2, 2, 5, 3, 4, 3], backgroundColor: 'rgba(96, 165, 250, 0.6)', borderColor: 'rgba(96, 165, 250, 1)', borderWidth: 1 }
            ]
        };
        const options = {
            responsive: true, maintainAspectRatio: false,
            interaction: { mode: 'index', intersect: false },
            scales: {
                x: { stacked: false, ticks: { font: { size: 12 } } },
                y: { beginAtZero: true, max: 5, ticks: { stepSize: 1, font: { size: 12 } } }
            },
            plugins: { legend: { position: 'bottom', labels: { usePointStyle: true, font: { size: 12 } } }, tooltip: { enabled: true } }
        };
        window.coreChart = new Chart(ctx, { type: 'bar', data, options });
    }

    function renderReferences() {
        document.getElementById('accordion-content').innerHTML = db.references.map(ref => 
            `<p><a href="${ref.url}" target="_blank" rel="noopener noreferrer" class="hover:text-yellow-300 transition-colors duration-300">${ref.text}</a></p>`
        ).join('');
    }
    
    function setupAccordion() {
        const button = document.getElementById('accordion-button');
        const content = document.getElementById('accordion-content');
        const arrow = document.getElementById('accordion-arrow');
        button.addEventListener('click', () => {
            if (content.style.maxHeight) {
                content.style.maxHeight = null;
                arrow.style.transform = 'rotate(0deg)';
            } else {
                content.style.maxHeight = content.scrollHeight + "px";
                arrow.style.transform = 'rotate(180deg)';
            }
        });
    }

    function setupRippleEffect() {
        document.body.addEventListener('mousedown', function(e) {
            const card = e.target.closest('.card-hover');
            if (!card) return;
            const rect = card.getBoundingClientRect();
            const circle = document.createElement('span');
            const diameter = Math.max(card.clientWidth, card.clientHeight);
            const radius = diameter / 2;
            circle.style.width = circle.style.height = `${diameter}px`;
            circle.style.left = `${e.clientX - rect.left - radius}px`;
            circle.style.top = `${e.clientY - rect.top - radius}px`;
            circle.classList.add('ripple');
            
            const ripple = card.getElementsByClassName('ripple')[0];
            if (ripple) ripple.remove();
            
            card.appendChild(circle);
        });
    }

    // [MODIFIED] 검색 아이콘 보이기/숨기기 및 스크롤 화살표 로직 수정
    const showHint = () => {
        if (searchHint) {
            searchHint.style.opacity = '1';
        }
    };

    const hideHint = () => {
        if (searchHint) {
            searchHint.style.opacity = '0';
        }
    };

    searchInput.addEventListener('focus', hideHint);

    searchInput.addEventListener('blur', () => {
        if (searchInput.value.trim() === '') {
            showHint();
        }
    });
    
    searchInput.addEventListener('input', () => {
        renderTables(searchInput.value);
        if (searchInput.value.trim() !== '') {
            hideHint();
            scrollArrow.classList.remove('opacity-0', 'pointer-events-none');
        } else {
            showHint(); // 검색창이 비워지면 아이콘 다시 표시
            scrollArrow.classList.add('opacity-0', 'pointer-events-none');
        }
    });

    renderAll();
});
</script>

</body>
</html>

